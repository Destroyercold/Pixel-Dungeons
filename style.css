body { 
    background: #050505; color: #eee; font-family: 'Press Start 2P', cursive; 
    display: flex; flex-direction: column; align-items: center; margin: 0; overflow: hidden; 
    image-rendering: pixelated; user-select: none;
}

#hud { 
    width: 1000px; background: #1a1a1a; padding: 15px; display: flex; justify-content: space-between; 
    border: 4px solid #666; margin-bottom: 5px; font-size: 10px; box-sizing: border-box; position: relative;
}

.bar-container { width: 200px; height: 15px; background: #000; border: 2px solid #fff; position: relative; margin-top: 5px; }
.hp-fill { height: 100%; background: #e22; transition: width 0.1s; }
.arm-fill { height: 100%; background: #aaa; transition: width 0.1s; position: absolute; top:0; left:0; mix-blend-mode: normal; }

#p2-hud-area { text-align: right; display: none; } 
.p2-bar { border-color: #f44; }
.p2-fill { background: #f44; }

#madman-timer { position: absolute; top: 40px; left: 50%; transform: translateX(-50%); font-size: 20px; color: #f0f; display: none; text-shadow: 2px 2px #000; }

#game-wrapper { position: relative; box-shadow: 0 0 50px #000; cursor: crosshair; }
canvas { background: #121212; display: block; border: 4px solid #444; }

#inventory-hud {
    width: 1000px; min-height: 60px; background: #111; border: 4px solid #444; border-top: none;
    display: flex; align-items: center; justify-content: center; gap: 10px; padding: 10px;
    flex-wrap: wrap; 
}
.inv-slot {
    width: 50px; height: 50px; border: 2px solid #666; background: #222; 
    display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 8px; cursor: pointer; color: #888;
    position: relative; flex-shrink: 0;
}
.inv-slot.active { border-color: #fe0; background: #333; color: #fff; box-shadow: 0 0 10px #fe0; }
.inv-key { position: absolute; top: 2px; left: 2px; color: #555; font-size: 6px; }
.ench-indicator { width: 6px; height: 6px; background: #a0a; border-radius: 50%; position: absolute; bottom: 2px; right: 2px; box-shadow: 0 0 5px #f0f; display: none; }

.overlay { 
    position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
    background: rgba(0,0,0,0.95); display: flex; flex-direction: column; 
    align-items: center; justify-content: center; z-index: 100;
}

/* MENU ORDER */
.char-select { display: flex; gap: 40px; margin-bottom: 30px; background: #222; padding: 20px; border: 2px solid #555; border-radius: 10px; }
.p-select { text-align: center; width: 200px; }
.skin-preview { width: 60px; height: 60px; border: 4px solid #fff; margin: 10px auto; display: inline-block; position: relative; }
.arrow-btn { background: #444; border: 1px solid #888; color: #fff; cursor: pointer; padding: 5px 10px; font-family: inherit; }
.class-display { color: #fe0; font-size: 10px; margin-top: 10px; border-top: 1px solid #444; padding-top: 10px; }

.menu-btn-group { display: flex; flex-direction: column; gap: 10px; width: 350px; }
.btn { background: #222; color: #fff; padding: 15px; border: 4px solid #fff; cursor: pointer; font-family: 'Press Start 2P'; font-size: 12px; text-transform: uppercase; width: 100%; transition: 0.1s;}
.btn-small { width: auto; padding: 10px; font-size: 10px; }
.btn:hover { background: #fff; color: #000; transform: translateY(-2px); }
.btn-refresh { width: auto; font-size: 10px; padding: 10px; border-color: #f0f; color: #f0f; margin-bottom: 10px;} 

/* SHOP CLEANUP */
.shop-container { display: flex; width: 900px; height: 500px; gap: 20px; }
.shop-col { flex: 1; border: 2px solid #555; padding: 15px; background: #151515; overflow-y: auto; display: flex; flex-direction: column; gap: 12px; }
.shop-title { color: #fe0; border-bottom: 2px solid #555; padding-bottom: 10px; margin-bottom: 5px; text-align: center; font-size: 12px; }
.shop-item { background: #222; border: 1px solid #444; padding: 10px; display: flex; flex-direction: column; align-items: center; gap: 5px; cursor: pointer; transition: 0.2s; position: relative; min-height: 50px; justify-content: center;}
.shop-item:hover { background: #333; border-color: #fff; box-shadow: 0 4px 10px #000; }
.shop-item.purchased { opacity: 0.5; pointer-events: none; border-color: #444; background: #111; }
.shop-item.sell-mode { border-color: #f44; }
.shop-item.sell-mode:hover { background: #422; box-shadow: 0 0 10px #f00; }
.shop-item.cant-sell { opacity: 0.5; cursor: not-allowed; border-color: #444; }
.relic-card { border-color: #0af; }
.relic-desc { font-size: 8px; color: #aaa; text-align: center; margin: 2px 0; }

.boss-text { position: absolute; color: #f00; font-size: 20px; text-shadow: 2px 2px #000; pointer-events: none; display: none; width: 100%; text-align: center; top: 100px; z-index: 50;}
.diff-text { color: #f44; font-size: 8px; margin-top: 5px; }

#mission-hud { position: absolute; bottom: 80px; left: 0; width: 100%; text-align: center; color: #fff; font-size: 12px; background: rgba(34,34,34,0.8); padding: 10px 0; border: 2px solid #444; display: none; }
.mission-complete { color: #0f0 !important; text-shadow: 0 0 5px #0f0; }

.opt-row { display: flex; justify-content: space-between; width: 600px; margin: 5px 0; font-size: 12px; align-items: center; }
.opt-val { color: #fe0; cursor: pointer; }
.key-btn { background: #333; border: 2px solid #666; color: #fff; padding: 5px 10px; font-family: inherit; font-size: 10px; cursor: pointer; width: 100px; text-align: center;}
.key-btn:hover { border-color: #fff; background: #444; }
.key-btn.binding { background: #a00; border-color: #f00; color: #fff; animation: blink 0.5s infinite; }
@keyframes blink { 0% {opacity:1;} 50% {opacity:0.5;} 100% {opacity:1;} }
.controls-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; width: 800px; margin-top: 20px; max-height: 300px; overflow-y: auto; }
.control-group { border: 1px solid #444; padding: 10px; background: #111; }

/* SANDBOX PANEL CLÁSICO */
#sandbox-controls { position: absolute; top: 80px; right: 20px; width: 150px; text-align: right; display: none; z-index: 20;}
.sb-btn { background: #000; border: 1px solid #0ff; color: #0ff; font-family: inherit; font-size: 10px; padding: 5px; cursor: pointer; margin-bottom: 5px; width: 100%; }
.sb-btn:hover { background: #004444; }
.sb-active { background: #008888; color: #fff; }

/* ENCHANT UI */
#enchant-menu { display: none; }
.enchant-cards { display: flex; gap: 20px; justify-content: center; width: 100%; margin-top: 20px; }
.enchant-card { width: 200px; height: 250px; background: #150515; border: 2px solid #a0a; padding: 15px; display: flex; flex-direction: column; align-items: center; justify-content: space-between; cursor: pointer; transition: 0.2s; text-align: center; }
.enchant-card:hover { transform: scale(1.05); background: #2a0a2a; border-color: #f0f; box-shadow: 0 0 20px #f0f; }
.ench-title { color: #f0f; font-size: 14px; margin-bottom: 10px; }
.ench-desc { color: #ccc; font-size: 10px; line-height: 1.5; }
.ench-type { color: #666; font-size: 8px; margin-top: auto; }

/* MUSIC UI */
.music-section { border: 1px solid #0af; padding: 10px; margin-bottom: 10px; width: 600px; text-align: center; background: #051520; }
input[type=range] { accent-color: #0af; }
/* --- ESTILOS MÓVILES --- */
#mobile-controls {
    display: none; /* Oculto por defecto en PC */
    position: fixed;
    bottom: 20px;
    left: 0;
    width: 100%;
    height: 150px;
    pointer-events: none; /* Dejar pasar toques fuera de botones */
    z-index: 200;
    justify-content: space-between;
    padding: 0 20px;
    box-sizing: border-box;
}

.d-btn, .a-btn {
    pointer-events: auto; /* Activar botones */
    background: rgba(255,255,255,0.1);
    border: 2px solid rgba(255,255,255,0.5);
    color: #fff;
    border-radius: 50%;
    width: 50px; height: 50px;
    font-size: 20px;
    touch-action: manipulation; /* Evitar zoom doble tap */
}

.d-btn:active, .a-btn:active { background: rgba(255,255,255,0.4); transform: scale(0.95); }

#dpad { display: flex; flex-direction: column; align-items: center; gap: 5px; }
.dpad-row { display: flex; gap: 5px; }

#actions { display: flex; align-items: flex-end; gap: 15px; padding-bottom: 10px; }

/* Hacer el juego responsive */
@media (max-width: 1024px) {
    body { overflow: hidden; background: #000; }
    #hud { width: 100%; padding: 5px; font-size: 8px; }
    #inventory-hud { width: 100%; }
    
    #game-wrapper {
        width: 100vw;
        height: auto;
        display: flex; justify-content: center;
    }
    
    canvas {
        width: 100%;
        height: auto;
        max-height: 60vh; /* Dejar espacio para controles */
        object-fit: contain;
    }

    /* Ajustes menú movil */
    .char-select { flex-direction: column; gap: 10px; padding: 10px; }
    .shop-container { flex-direction: column; width: 95vw; height: 60vh; }
    .btn { padding: 10px; }
    h1 { font-size: 20px !important; }
}

/* --- ESTILOS MÓVILES --- */
#mobile-controls {
    display: none; /* Oculto por defecto en PC */
    position: fixed;
    bottom: 20px;
    left: 0;
    width: 100%;
    height: 150px;
    pointer-events: none; /* Dejar pasar toques fuera de botones */
    z-index: 200;
    justify-content: space-between;
    padding: 0 20px;
    box-sizing: border-box;
}

.d-btn, .a-btn {
    pointer-events: auto; /* Activar botones */
    background: rgba(255,255,255,0.1);
    border: 2px solid rgba(255,255,255,0.5);
    color: #fff;
    border-radius: 50%;
    width: 50px; height: 50px;
    font-size: 20px;
    touch-action: manipulation; /* Evitar zoom doble tap */
}

.d-btn:active, .a-btn:active { background: rgba(255,255,255,0.4); transform: scale(0.95); }

#dpad { display: flex; flex-direction: column; align-items: center; gap: 5px; }
.dpad-row { display: flex; gap: 5px; }

#actions { display: flex; align-items: flex-end; gap: 15px; padding-bottom: 10px; }

/* Hacer el juego responsive */
@media (max-width: 1024px) {
    body { overflow: hidden; background: #000; }
    #hud { width: 100%; padding: 5px; font-size: 8px; }
    #inventory-hud { width: 100%; }
    
    #game-wrapper {
        width: 100vw;
        height: auto;
        display: flex; justify-content: center;
    }
    
    canvas {
        width: 100%;
        height: auto;
        max-height: 60vh; /* Dejar espacio para controles */
        object-fit: contain;
    }

    /* Ajustes menú movil */
    .char-select { flex-direction: column; gap: 10px; padding: 10px; }
    .shop-container { flex-direction: column; width: 95vw; height: 60vh; }
    .btn { padding: 10px; }
    h1 { font-size: 20px !important; }
}